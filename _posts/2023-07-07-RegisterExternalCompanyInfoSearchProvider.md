---
title: Загрузка реквизитов организации из внешнего сервиса
layout: default
---

Начиная с V8Preview5 можно упростить заполнение полей при редактировании данных организации. Пользователю будет достаточно ввести только ИНН, а далее плагин выполнит поиск во внешней системе и iikoFront заполнит остальные реквизиты компании.

Для этого в API добавлен новый метод [`RegisterExternalCompanyInfoSearchProvider`](https://iiko.github.io/front.api.sdk/v8/html/M_Resto_Front_Api_IOperationService_RegisterExternalCompanyInfoSearchProvider.htm), с помощью которого можно зарегистрировать в iikoFront метод, выполняющий функцию провайдера поиска организации по ИНН. Предполагается, что в callback-методе `getCompanyInfoCallback` разработчиками плагина будет вызываться сторонний сервис поиска компании по ИНН. Т.о. официант, находясь в окне "Реквизиты организации", сможет автоматически получить информацию о новой или обновить данные уже существующей организации.

Для передачи информации об организации из плагина в iikoFront добавлен класс [`ExternalCompanyInfo`](https://iiko.github.io/front.api.sdk/v8/html/T_Resto_Front_Api_Data_Brd_ExternalCompanyInfo.htm). В аргументах `RegisterExternalCompanyInfoSearchProvider` передается callback-метод `Func<string, ExternalCompanyInfo> getCompanyInfoCallback`, принимающий на вход строку с ИНН искомой организации, и возвращающий информацию об организации в dto типа `ExternalCompanyInfo`. 

Возвращенные методом `getCompanyInfoCallback` данные об организации будут отображены в окне "Реквизиты организации". Для уже существующей в iikoFront организации метод `getCompanyInfoCallback` будет вызываться в окне "Реквизиты организации" по кнопке "Обновить", принимая на вход значение из поля "ИНН". Для добавляемой в iikoFront новой организации метод `getCompanyInfoCallback` будет вызываться после нажатия в окне "Реквизиты организации" кнопки "Внешний поиск", когда в открывшемся диалоговом окне "Найти и добавить новую организацию" будет нажата кнопка "Искать". В этом случае аргументом callback-метода станет введенное в строку поиска значение.